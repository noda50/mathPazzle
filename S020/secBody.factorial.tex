%%----------------------------------------------------------------------
\section{階乗に関する問題}
\label{s:階乗}
%% - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

%%--------------------------------------------------
\subsection{階乗を割った余り}
\label{ssec:階乗:階乗を割った余り}
%% - - - - - - - - - - - - - - - - - - - - - - - - -
%%-----------------------------
\subsubsection{問題}
\label{sssec:階乗:階乗を割った余り:問題}
%% - - - - - - - - - - - - - -

$100 !$ を $97$ で割った余りはいくらか？


\clearpage
%%------------------------------
\subsubsection{解答}
\label{sssec:階乗:階乗を割った余り:解答}
%% - - - - - - - - - - - - - - -

$100 ! = 100 \cdot 99 \cdot 98 \cdot 97 \cdot 96 \ldots$ であるので、
$100!$ は $97$ を因子として持つ。
よって、$100!$ を $97$ で割った余りは 0 である。


%%------------------------------
\subsubsection{参考: Wilson の定理}
\label{sssec:階乗:階乗を割った余り:参考}
%% - - - - - - - - - - - - - - -

\begin{Theorem}
  $p$ が素数ならば、 $(p-1)! = -1 \mod p$ である。
  \\
  逆に、自然数 $p > 1$ に対し $(p-1)! = -1 \mod p$ ならば、
  $p$ は素数である。
\end{Theorem}
  

\clearpage
%%--------------------------------------------------
\subsection{階乗の階乗を割った余り}
\label{ssec:階乗:階乗の階乗を割った余り}
%% - - - - - - - - - - - - - - - - - - - - - - - - -

%%-----------------------------
\subsubsection{問題}
\label{sssec:階乗:階乗の階乗を割った余り:問題}
%% - - - - - - - - - - - - - -

$(100 !)!$ を $(99!)^{100}$ で割った余りはいくらか？


\clearpage
%%------------------------------
\subsubsection{解答}
\label{sssec:階乗:階乗の階乗を割った余り:解答}
%% - - - - - - - - - - - - - - -

\begin{Lemma}
  $n$ を自然数、$m$ を非負の整数とし、$n \ge m$ とする。
  この時、
  $n!$ は $m! \cdot (n-m)!$ で割り切れる。
  ただし、$0! = 1$ とする。
\end{Lemma}
\begin{Proof}
    $m=0$の時、
    $m! \cdot (n-m)! = 0! \cdot n! = n!$ となるので、
    $n!$ は $m! \cdot (n-m)!$ で割り切れる。

    また、$m=n$の時、
    $m! \cdot (n-m)! = n! \cdot 0! = n!$ となるので、
    $n!$ は $m! \cdot (n-m)!$ で割り切れる。

    $n=1$ の時、可能な $m$ は $0,1$ であり、
    これらは上記の条件のいずれかに当たるので、
    $n=1$ の時、$n!$ は $m! \cdot (n-m)!$ で割り切れる。

    仮に、ある $n$ に対し、$n!$ は $m! \cdot (n-m)!$ で割り切れると仮定する。
    つまり、$\frac{n!}{m! \cdot (n-m)!}$ は整数であるとする。
    この時、$\frac{(n+1)!}{m! \cdot (n+1-m)!}$ の値を求めてみる。
      %%$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
      \begin{eqnarray}
          \frac{(n+1)!}{m! \cdot (n+1-m)!}
            & = &
              \frac{(n+1) \cdot n!}{m \cdot (m-1)! \cdot (n+1-m) \cdot (n-m)!}
          \\
            & = &
              \frac{((n+1-m)+m) \cdot n!}{m \cdot (m-1)! \cdot (n+1-m) \cdot (n-m)!}
          \\
            & = &
              \frac{(n+1-m) \cdot n!}{m \cdot (m-1)! \cdot (n+1-m) \cdot (n-m)!}
          \nonumber \\ & &
            + \frac{m \cdot n!}{m \cdot (m-1)! \cdot (n+1-m) \cdot (n-m)!}
          \\
            & = &
              \frac{n!}{m! \cdot (n-m)!}
            + \frac{n!}{(m-1)! \cdot (n+1-m)!}
      \end{eqnarray}
      %%$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
    $\frac{n!}{m! \cdot (n-m)!}$ および $\frac{n!}{(m-1)! \cdot (n+1-m)!}$ は、
    仮定より整数である。
    よって、その和である $\frac{(n+1)!}{m! \cdot (n+1-m)!}$ は整数である。
    すなわち、$(n+1)!$ は $m! \cdot (n+1-m)!$ で割り切れる。
\end{Proof}

\begin{Theorem}
  自然数の列 $\Seq{k_1, k_2, \cdots, k_n}$ を考える、この時、
  $\left( \sum_{i=1}^{n} k_i \right) !$ は
  $\prod_{i=1}^{n} k_i !$ で割り切れる。
\end{Theorem}

$k_1 = k_2 = \cdots = k_{100} = 99!$ とすれば、
$\sum_{i=1}^{100} k_i = 100 \cdot 99! = 100!$ であり、
$\prod_{i=1}^{100} k_i = (99!)^{100} $ である。
これにより、上記の定理を使うと、
$(100!)!$ は $(99!)^{100}$ で割り切れる。
\QED



